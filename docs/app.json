[{"name":"app.R","content":"library(shiny)\n\n# =========================================\n# Preload all CSVs from URLs into a list\n# =========================================\n\n# ---- Define data sources by URL ----\ndata_sources <- list(\n  ex1 = \"https://raw.githubusercontent.com/jessalynnsebastian/intro_stat_shiny_r/main/app/data/ex1.csv\",\n  ex2 = \"https://raw.githubusercontent.com/jessalynnsebastian/intro_stat_shiny_r/main/app/data/ex2.csv\"\n  # add more here\n)\n\n# ---- Download + read them into the webR filesystem ----\ndata_list <- list()\nif (length(data_sources) > 0) {\n  for (nm in names(data_sources)) {\n    url <- data_sources[[nm]]\n    local_name <- paste0(nm, \".csv\")\n    download.file(url, local_name, quiet = TRUE)\n    data_list[[nm]] <- read.csv(local_name)\n  }\n}\n\n# =========================================\n# Safety: Blocklist dangerous functions\n# =========================================\n\ndangerous_functions <- c(\n  \"system\", \"system2\", \"shell\", \"exec\",\n  \"write.csv\", \"write.table\", \"saveRDS\", \"save\",\n  \"download.file\", \"url\",\n  \"source\", \"eval\", \"parse\",\n  \"library\", \"require\", \"install.packages\",\n  \"unlink\", \"file.remove\", \"file.create\",\n  \".Internal\", \".External\", \".Call\",\n  \"Sys.system\", \"Sys.command\"\n)\n\ncheck_code_safety <- function(code_text) {\n  # Check if any dangerous functions are mentioned in the code\n  for (func in dangerous_functions) {\n    # Simple pattern: function name followed by (\n    pattern <- paste0(\"\\\\b\", func, \"\\\\s*\\\\(\")\n    if (grepl(pattern, code_text, ignore.case = TRUE)) {\n      return(paste(\"Error: Function '\", func, \"' is not allowed for security reasons.\", sep = \"\"))\n    }\n  }\n  return(NULL)  # Safe\n}\n\n# =========================================\n# Simple help text for supported functions\n# =========================================\n\nhelp_texts <- list(\n  hist = \"\nhist(x, breaks = ...)\n\nCreates a histogram of a numeric vector x.\n- x: numeric data (e.g. data$height)\n- breaks: number of bins (or a vector of break points)\n\nExample:\n  hist(survey$height, breaks = 10)\n\",\n  qnorm = \"\nqnorm(p, mean = 0, sd = 1)\n\nGives the quantile (cutoff) of a Normal(mean, sd) distribution.\n- p: probability (e.g. 0.975 for a 97.5% cutoff)\n- mean, sd: mean and standard deviation\n\nExample:\n  qnorm(0.975)       # z* for a 95% CI\n\",\n  rnorm = \"\nrnorm(n, mean = 0, sd = 1)\n\nGenerates n random draws from a Normal(mean, sd).\n- n: number of draws\n- mean, sd: mean and standard deviation\n\nExample:\n  rnorm(5, mean = 10, sd = 2)\n\",\n  dnorm = \"\ndnorm(x, mean = 0, sd = 1, log = FALSE)\n\nReturns the density f(x) for a Normal(mean, sd).\n- x: numeric vector of points\n- mean, sd: mean and standard deviation\n- log: TRUE to return log-density\n\nExample:\n  dnorm(0)  # ~0.3989\n\",\n  pnorm = \"\npnorm(q, mean = 0, sd = 1, lower.tail = TRUE)\n\nReturns P(X <= q) for a Normal(mean, sd).\n- q: cutoff value\n- mean, sd: mean and standard deviation\n- lower.tail: FALSE gives P(X > q)\n\nExample:\n  pnorm(1.96)       # ~0.975\n\",\n  t_test = \"\nt.test(x, y = NULL, mu = 0, conf.level = 0.95)\n\nPerforms a t-test.\n- One-sample: t.test(x, mu = mean_under_H0)\n- Two-sample: t.test(x ~ group, data = ...)\n\nExample:\n  t.test(survey$height, mu = 170)\n\",\n  plot = \"\nplot(y ~ x, data = ...)\n\nCreates a scatterplot of y versus x from a data frame.\n- x: numeric predictor\n- y: numeric response\n\nExample:\n  plot(height ~ weight, data = survey)\n\"\n)\n\nui <- fluidPage(\n  titlePanel(\"Intro Stats: Interactive R Code Helper\"),\n  \n  tags$head(\n    tags$style(HTML(\"\n      #data_preview {\n        max-height: 400px;\n        overflow-y: auto;\n        overflow-x: auto;\n        display: block;\n      }\n    \"))\n  ),\n\n  sidebarLayout(\n    sidebarPanel(\n      tabsetPanel(\n        id = \"helper_tabs\",\n\n        # ---- Data tab: choose dataset and see preview ----\n        tabPanel(\n          \"Data\",\n          uiOutput(\"data_ui\"),\n          br(),\n          h5(\"Preview of selected dataset:\"),\n          tableOutput(\"data_preview\")\n        ),\n\n        # ---- Graphics tab: histogram & scatterplot ----\n        tabPanel(\n          \"Graphics\",\n          uiOutput(\"graphics_ui\")\n        ),\n\n        # ---- Distributions tab: Normal helpers ----\n        tabPanel(\n          \"Distributions\",\n          uiOutput(\"dist_ui\")\n        )\n\n        # Later you can add:\n        # tabPanel(\"Statistics\", ...)\n      )\n    ),\n\n    mainPanel(\n      h4(\"R code (you can edit this):\"),\n      textAreaInput(\n        \"code\",\n        label = NULL,\n        value = \"x <- rnorm(10)\\nmean(x)\\nsd(x)\",\n        rows = 10,\n        width = \"100%\"\n      ),\n      br(),\n      actionButton(\"run\", \"Run code\"),\n      hr(),\n      h4(\"Text / numeric output:\"),\n      verbatimTextOutput(\"text_out\"),\n      h4(\"Plot output:\"),\n      plotOutput(\"plot_out\", height = \"300px\"),\n      hr(),\n      h4(\"Function help:\"),\n      verbatimTextOutput(\"fun_help\")\n    )\n  )\n)\n\nserver <- function(input, output, session) {\n\n  # Environment that persists across runs in this browser session\n  user_env <- new.env(parent = globalenv())\n\n  # Put all preloaded datasets into the user environment\n  if (length(data_list) > 0) {\n    for (nm in names(data_list)) {\n      assign(nm, data_list[[nm]], envir = user_env)\n    }\n  }\n\n  # Reactive value for which function's help to show\n  current_fun <- reactiveVal(NULL)\n  \n  # Reactive value to store uploaded dataset\n  uploaded_data <- reactiveVal(NULL)\n\n  # =====================\n  # Data tab\n  # =====================\n\n  output$data_ui <- renderUI({\n    preloaded_choices <- if (length(data_list) > 0) names(data_list) else c()\n    \n    # Add uploaded dataset to choices if available\n    all_choices <- c(preloaded_choices, if (!is.null(uploaded_data())) \"(uploaded)\" else c())\n\n    tagList(\n      h5(\"Upload a CSV file:\"),\n      fileInput(\n        \"upload_file\",\n        \"Choose CSV file:\",\n        accept = c(\".csv\", \"text/csv\")\n      ),\n      hr(),\n      h5(\"Or select a preloaded dataset:\"),\n      if (length(all_choices) > 0) {\n        selectInput(\n          \"dataset_name\",\n          \"Select dataset to preview:\",\n          choices = all_choices\n        )\n      } else {\n        helpText(\"No datasets available. Upload a CSV file to get started.\")\n      }\n    )\n  })\n\n  # Handle file upload\n  observeEvent(input$upload_file, {\n    file_path <- input$upload_file$datapath\n    if (!is.null(file_path)) {\n      tryCatch(\n        {\n          df <- read.csv(file_path)\n          uploaded_data(df)\n          # Assign to user environment for code execution\n          assign(\"uploaded\", df, envir = user_env)\n        },\n        error = function(e) {\n          showNotification(\n            paste(\"Error reading file:\", e$message),\n            type = \"error\",\n            duration = 5\n          )\n        }\n      )\n    }\n  })\n\n  output$data_preview <- renderTable({\n    # Use uploaded data if available and selected, otherwise use preloaded\n    dataset_choice <- input$dataset_name\n    \n    if (!is.null(dataset_choice)) {\n      if (dataset_choice == \"(uploaded)\") {\n        df <- uploaded_data()\n      } else {\n        df <- data_list[[dataset_choice]]\n      }\n      \n      if (!is.null(df)) {\n        head(df)\n      }\n    }\n  }, rownames = TRUE)\n\n  # =====================\n  # Graphics tab\n  # =====================\n\n  output$graphics_ui <- renderUI({\n    # Dataset choice is optional: \"\" means \"none\"\n    choices <- c(\"(none, I'll type my own)\" = \"\", names(data_list))\n\n    tagList(\n      selectInput(\n        \"g_dataset\",\n        \"Choose a preloaded dataset (optional):\",\n        choices = choices\n      ),\n      tabsetPanel(\n        id = \"graphics_tabs\",\n\n        # Histogram sub-tab\n        tabPanel(\n          \"Histogram\",\n          uiOutput(\"g_hist_var_ui\"),\n          numericInput(\n            \"g_breaks\",\n            \"Number of breaks (bins):\",\n            value = 10, min = 1, step = 1\n          ),\n          actionButton(\"insert_hist\", \"Insert hist() code into editor\")\n        ),\n\n        # Scatterplot sub-tab\n        tabPanel(\n          \"Scatterplot\",\n          uiOutput(\"g_scatter_ui\"),\n          actionButton(\"insert_scatter\", \"Insert scatterplot code into editor\")\n        )\n      )\n    )\n  })\n\n  # =====================\n  # Distributions tab\n  # =====================\n\n  output$dist_ui <- renderUI({\n    tagList(\n      selectInput(\n        \"dist_family\",\n        \"Choose a distribution:\",\n        choices = c(\"Normal\", \"Student's t\", \"Binomial\", \"Uniform\")\n      ),\n      selectInput(\n        \"dist_type\",\n        \"Choose what to compute:\",\n        choices = c(\"Samples\", \"Density/Mass\", \"CDF\", \"Quantiles\")\n      ),\n      uiOutput(\"dist_params_ui\"),\n      actionButton(\"insert_dist\", \"Insert code\")\n    )\n  })\n\n  # Render parameter inputs based on distribution + type selection\n  output$dist_params_ui <- renderUI({\n    family <- input$dist_family\n    dtype <- input$dist_type\n    \n    if (is.null(family) || is.null(dtype)) return(NULL)\n\n    # Normal distribution\n    if (family == \"Normal\") {\n      if (dtype == \"Samples\") {\n        return(tagList(\n          numericInput(\"d_n\", \"Number of samples:\", value = 100, min = 1, step = 1),\n          numericInput(\"d_mean\", \"Mean:\", value = 0),\n          numericInput(\"d_sd\", \"SD:\", value = 1, min = 0.01, step = 0.1)\n        ))\n      } else if (dtype == \"Density/Mass\") {\n        return(tagList(\n          numericInput(\"d_x\", \"x value:\", value = 0),\n          numericInput(\"d_mean\", \"Mean:\", value = 0),\n          numericInput(\"d_sd\", \"SD:\", value = 1, min = 0.01, step = 0.1)\n        ))\n      } else if (dtype == \"CDF\") {\n        return(tagList(\n          numericInput(\"d_q\", \"Quantile:\", value = 0),\n          numericInput(\"d_mean\", \"Mean:\", value = 0),\n          numericInput(\"d_sd\", \"SD:\", value = 1, min = 0.01, step = 0.1)\n        ))\n      } else if (dtype == \"Quantiles\") {\n        return(tagList(\n          numericInput(\"d_p\", \"Probability:\", value = 0.5, min = 0, max = 1, step = 0.01),\n          numericInput(\"d_mean\", \"Mean:\", value = 0),\n          numericInput(\"d_sd\", \"SD:\", value = 1, min = 0.01, step = 0.1)\n        ))\n      }\n    }\n\n    # Student's t distribution\n    if (family == \"Student's t\") {\n      if (dtype == \"Samples\") {\n        return(tagList(\n          numericInput(\"d_n\", \"Number of samples:\", value = 100, min = 1, step = 1),\n          numericInput(\"d_df\", \"Degrees of freedom:\", value = 10, min = 1, step = 1)\n        ))\n      } else if (dtype == \"Density/Mass\") {\n        return(tagList(\n          numericInput(\"d_x\", \"x value:\", value = 0),\n          numericInput(\"d_df\", \"Degrees of freedom:\", value = 10, min = 1, step = 1)\n        ))\n      } else if (dtype == \"CDF\") {\n        return(tagList(\n          numericInput(\"d_q\", \"Quantile:\", value = 0),\n          numericInput(\"d_df\", \"Degrees of freedom:\", value = 10, min = 1, step = 1)\n        ))\n      } else if (dtype == \"Quantiles\") {\n        return(tagList(\n          numericInput(\"d_p\", \"Probability:\", value = 0.5, min = 0, max = 1, step = 0.01),\n          numericInput(\"d_df\", \"Degrees of freedom:\", value = 10, min = 1, step = 1)\n        ))\n      }\n    }\n\n    # Binomial distribution\n    if (family == \"Binomial\") {\n      if (dtype == \"Samples\") {\n        return(tagList(\n          numericInput(\"d_n\", \"Number of samples:\", value = 100, min = 1, step = 1),\n          numericInput(\"d_size\", \"Number of trials:\", value = 10, min = 1, step = 1),\n          numericInput(\"d_prob\", \"Probability of success:\", value = 0.5, min = 0, max = 1, step = 0.1)\n        ))\n      } else if (dtype == \"Density/Mass\") {\n        return(tagList(\n          numericInput(\"d_k\", \"Number of successes:\", value = 5, min = 0, step = 1),\n          numericInput(\"d_size\", \"Number of trials:\", value = 10, min = 1, step = 1),\n          numericInput(\"d_prob\", \"Probability of success:\", value = 0.5, min = 0, max = 1, step = 0.1)\n        ))\n      } else if (dtype == \"CDF\") {\n        return(tagList(\n          numericInput(\"d_q\", \"Quantile:\", value = 5, min = 0, step = 1),\n          numericInput(\"d_size\", \"Number of trials:\", value = 10, min = 1, step = 1),\n          numericInput(\"d_prob\", \"Probability of success:\", value = 0.5, min = 0, max = 1, step = 0.1)\n        ))\n      } else if (dtype == \"Quantiles\") {\n        return(tagList(\n          numericInput(\"d_p\", \"Probability:\", value = 0.5, min = 0, max = 1, step = 0.01),\n          numericInput(\"d_size\", \"Number of trials:\", value = 10, min = 1, step = 1),\n          numericInput(\"d_prob\", \"Probability of success:\", value = 0.5, min = 0, max = 1, step = 0.1)\n        ))\n      }\n    }\n\n    # Uniform distribution\n    if (family == \"Uniform\") {\n      if (dtype == \"Samples\") {\n        return(tagList(\n          numericInput(\"d_n\", \"Number of samples:\", value = 100, min = 1, step = 1),\n          numericInput(\"d_min\", \"Min:\", value = 0),\n          numericInput(\"d_max\", \"Max:\", value = 1)\n        ))\n      } else if (dtype == \"Density/Mass\") {\n        return(tagList(\n          numericInput(\"d_x\", \"x value:\", value = 0.5),\n          numericInput(\"d_min\", \"Min:\", value = 0),\n          numericInput(\"d_max\", \"Max:\", value = 1)\n        ))\n      } else if (dtype == \"CDF\") {\n        return(tagList(\n          numericInput(\"d_q\", \"Quantile:\", value = 0.5),\n          numericInput(\"d_min\", \"Min:\", value = 0),\n          numericInput(\"d_max\", \"Max:\", value = 1)\n        ))\n      } else if (dtype == \"Quantiles\") {\n        return(tagList(\n          numericInput(\"d_p\", \"Probability:\", value = 0.5, min = 0, max = 1, step = 0.01),\n          numericInput(\"d_min\", \"Min:\", value = 0),\n          numericInput(\"d_max\", \"Max:\", value = 1)\n        ))\n      }\n    }\n  })\n\n  # Handle insert for distributions\n  observeEvent(input$insert_dist, {\n    family <- input$dist_family\n    dtype <- input$dist_type\n\n    line <- \"\"\n\n    # Construct function call based on family and type\n    if (family == \"Normal\") {\n      if (dtype == \"Samples\") {\n        line <- sprintf(\"rnorm(%s, mean = %s, sd = %s)\", input$d_n, input$d_mean, input$d_sd)\n      } else if (dtype == \"Density/Mass\") {\n        line <- sprintf(\"dnorm(%s, mean = %s, sd = %s)\", input$d_x, input$d_mean, input$d_sd)\n      } else if (dtype == \"CDF\") {\n        line <- sprintf(\"pnorm(%s, mean = %s, sd = %s)\", input$d_q, input$d_mean, input$d_sd)\n      } else if (dtype == \"Quantiles\") {\n        line <- sprintf(\"qnorm(%s, mean = %s, sd = %s)\", input$d_p, input$d_mean, input$d_sd)\n      }\n    } else if (family == \"Student's t\") {\n      if (dtype == \"Samples\") {\n        line <- sprintf(\"rt(%s, df = %s)\", input$d_n, input$d_df)\n      } else if (dtype == \"Density/Mass\") {\n        line <- sprintf(\"dt(%s, df = %s)\", input$d_x, input$d_df)\n      } else if (dtype == \"CDF\") {\n        line <- sprintf(\"pt(%s, df = %s)\", input$d_q, input$d_df)\n      } else if (dtype == \"Quantiles\") {\n        line <- sprintf(\"qt(%s, df = %s)\", input$d_p, input$d_df)\n      }\n    } else if (family == \"Binomial\") {\n      if (dtype == \"Samples\") {\n        line <- sprintf(\"rbinom(%s, size = %s, prob = %s)\", input$d_n, input$d_size, input$d_prob)\n      } else if (dtype == \"Density/Mass\") {\n        line <- sprintf(\"dbinom(%s, size = %s, prob = %s)\", input$d_k, input$d_size, input$d_prob)\n      } else if (dtype == \"CDF\") {\n        line <- sprintf(\"pbinom(%s, size = %s, prob = %s)\", input$d_q, input$d_size, input$d_prob)\n      } else if (dtype == \"Quantiles\") {\n        line <- sprintf(\"qbinom(%s, size = %s, prob = %s)\", input$d_p, input$d_size, input$d_prob)\n      }\n    } else if (family == \"Uniform\") {\n      if (dtype == \"Samples\") {\n        line <- sprintf(\"runif(%s, min = %s, max = %s)\", input$d_n, input$d_min, input$d_max)\n      } else if (dtype == \"Density/Mass\") {\n        line <- sprintf(\"dunif(%s, min = %s, max = %s)\", input$d_x, input$d_min, input$d_max)\n      } else if (dtype == \"CDF\") {\n        line <- sprintf(\"punif(%s, min = %s, max = %s)\", input$d_q, input$d_min, input$d_max)\n      } else if (dtype == \"Quantiles\") {\n        line <- sprintf(\"qunif(%s, min = %s, max = %s)\", input$d_p, input$d_min, input$d_max)\n      }\n    }\n\n    old_code <- input$code\n    if (is.null(old_code)) old_code <- \"\"\n\n    new_code <- if (nzchar(old_code)) paste(old_code, line, sep = \"\\n\") else line\n    updateTextAreaInput(session, \"code\", value = new_code)\n    current_fun(tolower(gsub(\"\\\\(.*\", \"\", line)))\n  })\n\n  # ---- Histogram variable selector ----\n  output$g_hist_var_ui <- renderUI({\n    # No dataset selected: generic template\n    if (is.null(input$g_dataset) || input$g_dataset == \"\") {\n      return(helpText(\n        \"No dataset selected.\",\n        \"We'll insert a generic template like:\",\n        \"  hist(x, breaks = 10)\",\n        \"You can define x yourself in the code box (e.g. x <- rnorm(50)).\"\n      ))\n    }\n\n    df <- data_list[[input$g_dataset]]\n\n    numeric_cols <- names(df)[sapply(df, is.numeric)]\n    if (length(numeric_cols) == 0) {\n      return(helpText(\"No numeric variables found in this dataset.\"))\n    }\n\n    selectInput(\n      \"g_hist_var\",\n      \"Choose a numeric variable for the histogram:\",\n      choices = numeric_cols\n    )\n  })\n\n  # ---- Scatterplot variable selectors (x and y) ----\n  output$g_scatter_ui <- renderUI({\n    # No dataset selected: generic template\n    if (is.null(input$g_dataset) || input$g_dataset == \"\") {\n      return(helpText(\n        \"No dataset selected.\",\n        \"We'll insert a generic template like:\",\n        \"  plot(y ~ x)\",\n        \"You can define x and y yourself in the code box.\"\n      ))\n    }\n\n    df <- data_list[[input$g_dataset]]\n\n    numeric_cols <- names(df)[sapply(df, is.numeric)]\n    if (length(numeric_cols) < 2) {\n      return(helpText(\"Need at least two numeric variables for a scatterplot.\"))\n    }\n\n    tagList(\n      selectInput(\n        \"g_scatter_x\",\n        \"X variable (horizontal axis):\",\n        choices = numeric_cols\n      ),\n      selectInput(\n        \"g_scatter_y\",\n        \"Y variable (vertical axis):\",\n        choices = numeric_cols,\n        selected = numeric_cols[min(2, length(numeric_cols))]\n      )\n    )\n  })\n\n  # ---- Insert hist() code into the editor ----\n  observeEvent(input$insert_hist, {\n    # Branch on whether a dataset is selected\n    if (is.null(input$g_dataset) || input$g_dataset == \"\") {\n      # Generic template: student supplies x\n      line <- sprintf(\"hist(x, breaks = %s)\", input$g_breaks)\n    } else {\n      req(input$g_hist_var, input$g_breaks)\n      dataset_name <- input$g_dataset\n      line <- sprintf(\n        \"hist(%s$%s, breaks = %s)\",\n        dataset_name, input$g_hist_var, input$g_breaks\n      )\n    }\n\n    old_code <- input$code\n    if (is.null(old_code)) old_code <- \"\"\n\n    new_code <- if (nzchar(old_code)) {\n      paste(old_code, line, sep = \"\\n\")\n    } else {\n      line\n    }\n\n    updateTextAreaInput(session, \"code\", value = new_code)\n    current_fun(\"hist\")\n  })\n\n  # ---- Insert scatterplot code into the editor ----\n  observeEvent(input$insert_scatter, {\n    # Branch on whether a dataset is selected\n    if (is.null(input$g_dataset) || input$g_dataset == \"\") {\n      # Generic template: student defines x and y\n      line <- \"plot(y ~ x)\"\n    } else {\n      req(input$g_scatter_x, input$g_scatter_y)\n      dataset_name <- input$g_dataset\n      line <- sprintf(\n        \"plot(%s ~ %s, data = %s)\",\n        input$g_scatter_y,\n        input$g_scatter_x,\n        dataset_name\n      )\n    }\n\n    old_code <- input$code\n    if (is.null(old_code)) old_code <- \"\"\n\n    new_code <- if (nzchar(old_code)) {\n      paste(old_code, line, sep = \"\\n\")\n    } else {\n      line\n    }\n\n    updateTextAreaInput(session, \"code\", value = new_code)\n    current_fun(\"plot\")\n  })\n\n  # =====================\n  # Run code + outputs\n  # =====================\n\n  observeEvent(input$run, {\n    code_text <- input$code\n\n    # ---- Safety check: blocklist dangerous functions ----\n    safety_error <- check_code_safety(code_text)\n    if (!is.null(safety_error)) {\n      output$text_out <- renderText({ safety_error })\n      return(NULL)\n    }\n\n    # Clear previous outputs\n    output$text_out  <- renderText({ \"\" })\n    output$plot_out  <- renderPlot({ })\n\n    # Parse into multiple expressions\n    exprs <- try(parse(text = code_text), silent = TRUE)\n\n    if (inherits(exprs, \"try-error\")) {\n      output$text_out <- renderText({\n        paste(\"Parse error:\\n\", attr(exprs, \"condition\")$message)\n      })\n      return(NULL)\n    }\n\n    # Evaluate each expression, capture printed output\n    all_out <- character()\n\n    for (expr in exprs) {\n      this_out <- try(\n        {\n          # Set timeout to 5 seconds per expression\n          setTimeLimit(elapsed = 5, transient = TRUE)\n          res <- withVisible(eval(expr, envir = user_env))\n          capture.output(if (res$visible) print(res$value))\n        },\n        silent = TRUE\n      )\n\n      if (inherits(this_out, \"try-error\")) {\n        all_out <- c(\n          all_out,\n          paste(\"Error during evaluation:\",\n                attr(this_out, \"condition\")$message)\n        )\n      } else if (length(this_out) > 0) {\n        all_out <- c(all_out, this_out)\n      }\n    }\n\n    if (length(all_out) == 0) {\n      all_out <- \"[No printed output.]\"\n    }\n\n    output$text_out <- renderText({\n      paste(all_out, collapse = \"\\n\")\n    })\n\n    # Re-run code in a plotting context: any plotting calls will draw here\n    output$plot_out <- renderPlot({\n      setTimeLimit(elapsed = 5, transient = TRUE)\n      eval(parse(text = code_text), envir = user_env)\n    })\n  })\n\n  # =====================\n  # Function help panel\n  # =====================\n\n  output$fun_help <- renderText({\n    fun <- current_fun()\n    if (is.null(fun)) {\n      return(\"Select a template (e.g. insert hist() or scatterplot code) to see help.\")\n    }\n\n    txt <- help_texts[[fun]]\n    if (is.null(txt)) {\n      return(paste(\"No help text defined for function:\", fun))\n    }\n\n    txt\n  })\n}\n\nshinyApp(ui, server)\n","type":"text"},{"name":"data/ex1.csv","content":"sale_id,employee_id,amount,date\n101,1,1500,2024-01-12\n102,3,2400,2024-01-13\n103,2,800,2024-01-14\n104,1,1100,2024-01-15\n105,5,3000,2024-01-16\n","type":"text"},{"name":"data/ex2.csv","content":"employee_id,name,department,salary\n1,Alice,Engineering,92000\n2,Bob,Marketing,68000\n3,Charlie,Engineering,99000\n4,Danielle,HR,72000\n5,Edward,Finance,84000\n","type":"text"}]
